# Malware-Reverse-Engineering

***Objective:*** 

This project identifies a different type of malware and their functionality in my virtualized sandbox. This project examines the malware property and locates difference or similar patterns of each malware.
The second purpose of this project is to use different open source intelligence tools to gather more information for each malware. The information that I was interested are as follows:

1. Libraries & Strings - How can we get more information about malware's functionality from the file library and specified strings. 
2. Subsystem - what type of subsystem is being used in different malware.
3. Stamp Generator - When and where the malware compiled and originated.
4. Sections - How many levels of execution does each malware have.  


**Tools:** 


* [Pestudio](https://www.winitor.com/)

* [Fakenet](https://github.com/mandiant/flare-fakenet-ng)

* [Npcap](https://npcap.com/)

* [Wireshark](https://www.wireshark.org/)

* [Snort](https://www.snort.org/)


**Firewalls:** 

Before running any malware on my sandbox, I started my Intrusion Detection System (IDS) to ensure there is no other malicious activity currently on the operating system. Snort has a large amount or rule-sets that are very similar to a typical firewall rule. These set of rules are used to match network activity against a specific pattern or signatures and consequently decide whether to send an alert or drop the traffic for protection purposes.

![Snort_IDS](https://user-images.githubusercontent.com/96266650/169172268-097bf9ea-ac42-48a9-bbef-d786599fd206.gif)
> There are only few communications between OS and the browser websites. 

**TA578 & Bumblebee Malware:** 

"Contact Forms" is a campaign that uses a web site's contact form to email malicious links as a distribution vector. This form also disguised as sort of a legal form complaint. The first form of this malware was seen in 2021 and after recent discovery this type of malware also has been seen on thread-hicjacked emails to push hidden ISO files for Bumblebee malware.

![image](https://user-images.githubusercontent.com/96266650/169177777-6ab75901-4a27-4aae-ba15-f9072dc60f20.png)
> Hijacked email with malicious storage.googleapis.com link.

**Analysis:** 

As we know the malware has been already detected but Pestudio gives us more information about the malware. I used the compiler-stamp option in Pestudio to know when did this malware got generated.

After discovering different sections for this malware, it was interesting to see different type of executable and writable sections.
![image](https://user-images.githubusercontent.com/96266650/169181828-b7971dfc-c7a4-4872-84e1-52460a014c39.png)

Libraries also gives me more information of how many programs or functions would be running. For example the ```wsock32.dll``` indicated for socket or internet connection. This particular malware is also able to put the operating system into sleep mode while mainiting the post request, and sending data with the generated link.

```Loadlibrary``` is another critical function of this malware. This function will dynamically load other libraries, which means the finding might not be all the libraries. 

![image](https://user-images.githubusercontent.com/96266650/169182351-3ec9fc70-5ed3-4a8e-a274-3eca07f652ca.png)
![image](https://user-images.githubusercontent.com/96266650/169184876-d260c501-cf0f-49c4-b35f-1be03e339d8b.png)
> From list of the malware functions you can notice that this file will be intedning to run and send snapshot of server or files and ultimatly spy over the operating systgem. 


**Strings & Patterns:**

From this section, I was able to find where does the spyware is sending the packages to.
![image](https://user-images.githubusercontent.com/96266650/169186884-a1ac662d-9cec-4169-ac46-19df466e519c.png)



What I learned from this project was that, there are always a way for attackers to take a malware samples and change it's functionality and after that they will deploy the malware with different techniques. This type of malwares was send with a contact-form at first. Recently (May 2022) this malware has been sent by hijacked emails.


